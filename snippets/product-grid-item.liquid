{%- comment -%}
  Check if the product is on sale and set a variable to be used below.
{%- endcomment -%}
{%- assign on_sale = false -%}
{%- if product.compare_at_price > product.price -%}
  {%- assign on_sale = true -%}
{%- endif -%}

{%- comment -%}
  Check if the product is sold out and set a variable to be used below.
{%- endcomment -%}
{%- assign sold_out = true -%}
{%- if product.available -%}
  {%- assign sold_out = false -%}
{%- endif -%}

<div class="box product">
  {%- comment -%}
    Link to your product with the 'within: collection' filter for the link to be aware of the collection.
    This allows you to create collection-based navigation on the product page.

    Results of using 'within: collection':
    - Instead of a URL with /products/product-handle
      you would get /collections/collection-handle/products/product-handle

    For more info on navigation within a collection
      - http://docs.shopify.com/support/your-store/collections/how-to-navigate-within-a-collection

  {%- endcomment -%}
  {% capture img_id %}ProductGridImage-{{ section.id }}-{{ collection.id }}-{{ product.id }}{% endcapture %}
  {% capture wrapper_id %}ProductGridImageWrapper-{{ section.id }}-{{ collection.id }}-{{ product.id }}{% endcapture %}
  {% comment ls-rpl %}{%- assign img_url = product.featured_image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}{% endcomment %}{%- capture LS_IMG_URL -%}{%- render "ls-img-url", image: product.featured_image, img_url: '1x1' -%}{%- endcapture -%}{%- assign img_url = LS_IMG_URL | replace: '_1x1.', '_{width}x.' -%}{% comment /ls-rpl %}{% endcomment %}
  {%- comment %}
  	Auto-crop
    - Square
    --- set padding-top to 100%
    --- absolute top to 50% and transform translateY to -50%
  {% endcomment -%}
  <figure class="product-grid-item--{{ settings.collections_text_alignment }}">
    
    <a id="{{ wrapper_id }}" href="javascript:;" class="product_card">
      {%- assign image = product.featured_image -%}
      <div class="product_card__image-wrapper" data-bgset="{% include 'bgset', image: image %}">
        {% assign image_widths = '295,394,590,700,800,1000,1200,1500,1800,2000,2400' %}
        {% include 'theme-rias' %}
        <a href="{{ product.url }}" class="pro_url"><img id="{{ img_id }}" class="product_card__image lazyload {% if settings.variant_rollover == true and product.images.size > 1 %}featured{% endif %}"
          src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
          data-src="{{ image_url_pattern }}"
          data-widths="[{{ image_widths }}]"
          data-aspectratio="{{ image.aspect_ratio }}"
          data-sizes="auto"
          data-expand="600"
          data-fallback="{% comment ls-rpl %}{{ image | img_url: '295x' }}{% endcomment %}{%- capture LS_IMG_URL -%}{%- render "ls-img-url", image: image, img_url: '295x' -%}{%- endcapture -%}{{ LS_IMG_URL }}{% comment /ls-rpl %}{% endcomment %}"
          alt="{% comment ls-rpl %}{{ product.featured_image.alt | escape }}{% endcomment %}{%- capture LS_ALT -%}{%- render "ls-alt", image: product.featured_image -%}{%- endcapture -%}{{ LS_ALT | escape }}{% comment /ls-rpl %}{% endcomment %}">
        </a>
          <noscript>
          <img class="product_card__image" src="{% comment ls-rpl %}{{ image | img_url: '394x' }}{% endcomment %}{%- capture LS_IMG_URL -%}{%- render "ls-img-url", image: image, img_url: '394x' -%}{%- endcapture -%}{{ LS_IMG_URL }}{% comment /ls-rpl %}{% endcomment %}" alt="{% comment ls-rpl %}{{ product.featured_image.alt | escape }}{% endcomment %}{%- capture LS_ALT -%}{%- render "ls-alt", image: product.featured_image -%}{%- endcapture -%}{{ LS_ALT | escape }}{% comment /ls-rpl %}{% endcomment %}">
        </noscript>
        {%- assign collection_single_column_auto = false -%}
        {%- if settings.collections_product_columns == '1' and settings.collections_product_ratio == 'auto' -%}
          {%- assign collection_single_column_auto = true -%}
        {%- endif -%}
        {%- if settings.collections_product_ratio == 'false' or collection_single_column_auto -%}
          <style media="screen">
            {%- assign padding = 1 | divided_by: image.aspect_ratio | times: 100 | append: '%' -%}
            #{{ wrapper_id }} .product_card__image-wrapper:before { padding-bottom: {{ padding }}; }
          </style>
        {%- endif -%}
        {%- if settings.variant_rollover == true and product.images.size > 1 -%}
          {%- assign image = product.images[1] -%}
          {%- assign image_widths = '295,394,590,700,800,1000,1200,1500,1800,2000,2400' -%}
          {% include 'theme-rias' %}
          <a href="{{ product.url }}" class="pro_url"><img id="{{ img_id }}" class="product_card__image alt lazyload"
            data-src="{{ image_url_pattern }}"
            data-widths="[{{ image_widths }}]"
            data-aspectratio="{{ image.aspect_ratio }}"
            data-sizes="auto"
            data-expand="600"
            alt="{% comment ls-rpl %}{{ product.featured_image.alt | escape }}{% endcomment %}{%- capture LS_ALT -%}{%- render "ls-alt", image: product.featured_image -%}{%- endcapture -%}{{ LS_ALT | escape }}{% comment /ls-rpl %}{% endcomment %}">
          </a>
            {%- endif -%}
        {%- if sold_out -%}
          <span class="label sold-out label--{{ settings.collections_badge_placement }} {%- if settings.collections_badge_soldout -%}label--image{%- endif -%}">
            {%- if settings.collections_badge_soldout -%}
              {%- assign image = settings.collections_badge_soldout -%}
              {%- assign image_widths = '50,100' -%}
              {% include 'theme-rias' %}
              <img class="lazyload"
                src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
                data-src="{{ image_url_pattern }}"
                data-widths="[{{ image_widths }}]"
                data-aspectratio="{{ image.aspect_ratio }}"
                data-sizes="auto"
                data-expand="600"
                alt="{% comment ls-rpl %}{{ image.alt | escape }}{% endcomment %}{%- capture LS_ALT -%}{%- render "ls-alt", image: image -%}{%- endcapture -%}{{ LS_ALT | escape }}{% comment /ls-rpl %}{% endcomment %}">
            {%- else -%}
<!--               {{ 'products.product.sold_out' | t }} -->
              <ls-static-674915>COMING SOON</ls-static-674915>
            {%- endif -%}
          </span>
        {%- elsif on_sale -%}
          <span class="label sale label--{{ settings.collections_badge_placement }} {%- if settings.collections_badge_onsale -%}label--image{%- endif -%}">
            {%- if settings.collections_badge_onsale -%}
              {%- assign image = settings.collections_badge_onsale -%}
              {%- assign image_widths = '50,100' -%}
              {% include 'theme-rias' %}
              <img class="lazyload"
                src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
                data-src="{{ image_url_pattern }}"
                data-widths="[{{ image_widths }}]"
                data-aspectratio="{{ image.aspect_ratio }}"
                data-sizes="auto"
                data-expand="600"
                alt="{% comment ls-rpl %}{{ image.alt | escape }}{% endcomment %}{%- capture LS_ALT -%}{%- render "ls-alt", image: image -%}{%- endcapture -%}{{ LS_ALT | escape }}{% comment /ls-rpl %}{% endcomment %}">
            {%- else -%}
              {{ 'products.product.on_sale' | t }}
            {%- endif -%}
          </span>
        {%- endif -%}
        
      </div>
    </a>
    <span class="collection-size-swatch">
        <select id="variant-select" name="id" style="visibility: hidden; position: absolute; ">
          {% for variant in product.variants %}
          {% if variant.available %}
          <option data-title="{{ variant.title }}" data-img="{{variant.image|img_url:"master"}}"value="{{variant.id}}">{{ variant.title }}</option>
          {% else %}
          <option value="{{variant.id}}" disabled="disabled">{{ variant.title }} - sold out!</option>
          {% endif %}
          {% endfor %}
          </select>


          
        {%- unless product.has_only_default_variant -%}
          {%- for option in product.options_with_values -%}
        
              {% if option.name == 'Youth Size' %}
              <label for="ProductSelect-option-{{ forloop.index0 }}">
                {{ option.name | escape }}
              </label>
              <select id="ProductSelect-{{ forloop.index0 }}" data-index="option{{ forloop.index }}">
                 <option value="" selected="selected">Select Size</option>
                {%- for value in option.values -%}
                  {% comment %}{% if option.selected_value == value %} selected="selected"{% endif %} {% endcomment %}
                  <option value="{{ value | escape }}" {% unless product.variants[forloop.index0].available == true %}disabled{% endunless %}>
                    {{ value | escape }}
                  </option>
                {%- endfor -%}
              </select>
              {% endif %}
        
          {%- endfor -%}
        {%- endunless -%}


          
          {% comment %}
        {% unless sold_out %}      
          {% unless product.has_only_default_variant %}
            {% for option in product.options_with_values %}
              {% assign downcased_option = option.name | downcase %}
                {% if downcased_option contains 'size' %}
                  {% assign is_size = true %}
                  {% for value in option.values %}
                    {% assign variant_avialable = true %}
                    {% if product.options.size == 1 %}
                      {% unless product.variants[forloop.index0].available  %}
                        {% assign variant_avialable = false %}
                      {% endunless %}
                    {% endif %}
                    <span class="text-center size-values {% unless variant_avialable %}soldout{% endunless %} ">{{ value | escape }}</span>
                  {% endfor %}      
                {% endif %}
            {% endfor %}
          {% endunless %}      
        {% endunless %} {% endcomment %}
        </span>
    {%- if settings.collection_swatches -%}
      {% include 'product-grid-item-swatches' %}
    {%- endif -%}
        <figcaption>
          <div class="product-title">
            <a href="{{ product.url | within: collection }}" class="title">{{ product.title }}</a>
            {% if settings.show_vendors %}
              <span class="vendor">{{ product.vendor | link_to_vendor }}</span>
            {% endif %}
          </div>
          
    
    <span class="price">
          {% if on_sale %}
            {% if product.price_varies %}
              <span class="from">{{ 'products.general.from' | t }}</span>
              <span class="money">{{ product.price | money_with_currency  }}</span>
              <span class="original-price money">{{ product.compare_at_price | money_with_currency  }}</span>
            {% else %}
              <span class="money">{{ product.price | money_with_currency  }}</span>
              <span class="original-price money">{{ product.compare_at_price | money_with_currency  }}</span>
            {% endif %}
          {% else %}
            {% if product.price_varies %}<span class="from">{{ 'products.general.from' | t }}</span>{% endif %}
            <span class="money">{{ product.price | money_with_currency  }}</span>
          {% endif %}
          </span>
          {% comment %}Start automatically added Judge.me widget{% endcomment %}
          {% render 'judgeme_widgets', widget_type: 'judgeme_preview_badge', concierge_install: true, product: product %}
        {% comment %}End automatically added Judge.me widget{% endcomment %}
          <form method="post" action="/cart/add">
            <input type="hidden" name="id" value="{{ product.variants.first.id }}" />
            <input type="hidden" name="Color" value="black" />
            <input type="hidden" name="Youth Size" value="8" />
            <input type="hidden" name="quantity" value="1" />
            
            <input type="submit" value="Add To Cart" class="btn btn-primary" disabled /> 
          </form>
          
        </figcaption>
    
    
  </figure>
{% render 'preorder-now-collection-item', product: product %}</div>
{%- if settings.collections_product_ratio == 'auto' and related_products_section != true -%}
  {% include 'product-grid-item-auto-ratio' %}
{%- endif -%}
{% unless product.has_only_default_variant %}
    {%- comment -%}
      Dropdown colleciton of variant options
    {%- endcomment -%}
    {%- if section.settings.variant_style == 'dropdowns' -%}
      <div class="selection-wrapper variant js">
        <div class="variant-grid">
          {% for option in product.options_with_values %}
            {%- assign option_name = option.name | downcase -%}
            {%- assign size_options = 'products.product.size_option' | t -%}
            <div class="selector-wrapper">
              <label for="SingleOptionSelector-{{ forloop.index0 }}">
                {{ option.name }}
                {%- if section.settings.size_guide_page != blank and size_options contains option_name -%}
                <span class="label-extra"><a href="{{ pages[section.settings.size_guide_page].url }}" class="product-size-guide-{{ section.id }}">{{ pages[section.settings.size_guide_page].title }}</a></span>
                {%- endif -%}
              </label>

              <select class="single-option-selector single-option-selector-{{ section.id }}" id="SingleOptionSelector-{{ section.id }}-{{ forloop.index0 }}" data-name="{{ option.name }}" data-index="option{{ forloop.index }}">
                {% for value in option.values %}
                  <option value="{{ value | escape }}" {% if option.selected_value == value %}selected="selected"{% endif %}>
                    {{ value }}
                  </option>
                {% endfor %}
              </select>
            </div>
          {% endfor %}
          {% if section.settings.product_quantity_enable %}
            {% include 'quantity-selector' %}
          {% endif %}
        </div>
      </div>
    {%- comment -%}
      Button/swatch colleciton of variant options
    {%- endcomment -%}
    {%- elsif section.settings.variant_style == 'buttons' or section.settings.variant_style == 'swatches' -%}
      <div class="selection-wrapper variant radio js">
        {% for option in product.options_with_values %}
          {% include 'swatch' %}
        {% endfor %}
        {% if section.settings.product_quantity_enable %}
          {% include 'quantity-selector' %}
        {% endif %}
      </div>
    {%- endif -%}
  {% else %}
    {% if section.settings.product_quantity_enable %}
      <div class="selection-wrapper variant js">
        {% include 'quantity-selector' %}
      </div>
    {% else %}
      {%- assign cart_buttons_margin = 'cart_buttons__margin' -%}
    {% endif %}
  {% endunless %}
  
  {% comment %}
    Primary variant select controlled JS
  {% endcomment %}
  <div class="selection-wrapper variant no-js">
    <div class="selector-wrapper full-width">
      <select name="id" id="ProductSelect-{{ section.id }}" data-section="{{ section.id }}" class="product-form__variants no-js">
        {% for variant in product.variants %}
           
        {% if variant.available %}  
        <option value="{{ variant.id }}" data-sku="{{ variant.sku }}">{{ variant.title }} - {{ variant.price | money_with_currency }}</option>
          {% else %}
        <option disabled="disabled">{{ variant.title }} - {{ 'products.product.sold_out' | t }}</option>
         {% endif %}
           {% comment %}
          <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} value="{{ variant.id }}" data-sku="{{ variant.sku }}">
              {{ variant.title }} - {{ variant.price | money_with_currency }}
            </option>
       
          {% if variant.available %}
            <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} value="{{ variant.id }}" data-sku="{{ variant.sku }}">
              {{ variant.title }} - {{ variant.price | money_with_currency }}
            </option>
          {% else %}
            <option disabled="disabled">{{ variant.title }} - {{ 'products.product.sold_out' | t }}</option>
          {% endif %}{% endcomment %}
        {% endfor %}
      </select>
    </div>
  </div>
  <div class="error cart-error cart-error-{{ section.id }}" style="display:none;"></div>
  <div id="CartButtons-{{ section.id }}" class="cart-buttons {% if cart_buttons_margin %}{{ cart_buttons_margin }}{% endif %} {% if section.settings.show_payment_button and current_variant.available %}cart-buttons__enabled{% elsif section_onboarding %}cart-buttons__enabled{% endif %}">
    <div class="button-wrapper default-cart-button">
      <button type="submit" name="add" id="AddToCart-{{ section.id }}"  {% if preorder == true %} data-preorder {% endif %} class="default-cart-button__button {% unless current_variant.available or section_onboarding %}disabled{% endunless %}" {% unless current_variant.available %}disabled{% endunless %}  data-AddToCart>
        <span id="AddToCartText-{{ section.id }}" data-AddToCartText>
          {% unless current_variant.available or section_onboarding %}
            {{ 'products.product.sold_out' | t }}
          {% else %}
            {%- if preorder == true -%}
              {{ 'products.product.preorder' | t }}
            {%- else -%}
              {{ 'products.product.add_to_cart' | t }}
            {%- endif -%}
          {% endunless %}
        </span>
      </button>
    </div>
    <div id="PaymentButtonContainer-{{ section.id }}" class="payment-button__container">
      {% if section.settings.show_payment_button %}
        {{ form | payment_button }}
      {% endif %}
    </div>
  </div>